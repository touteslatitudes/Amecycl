!function(e,o,a,t){"use strict";const r="https://wxs.ign.fr/{ignApiKey}/geoportail/wmts?&REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&TILEMATRIXSET=PM&LAYER={ignLayer}&STYLE=normal&FORMAT={format}&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}",n='&copy; <a href="http://www.ign.fr/">IGN</a>';var i=[],s=[],p=function(e,o){switch(o.properties.ame_d){case"AUCUN":if(e.ameColors.hasOwnProperty(o.properties.ame_g))var a=e.ameColors[o.properties.ame_g];else a="SandyBrown";break;default:if(e.ameColors.hasOwnProperty(o.properties.ame_d))a=e.ameColors[o.properties.ame_d];else a="SandyBrown"}return{color:a,weight:e.ameWeight,opacity:e.ameOpacity}},c=function(e,o,t){o.properties&&t.on("click",function(){var t=o.properties,r=o.rid,n=a.createElement("table");for(var i in n.className="acy-table",t){var p,c=n.insertRow(-1);(p=c.insertCell(-1)).className="acy-table",p.innerHTML=i,(p=c.insertCell(-1)).className="acy-table",p.innerHTML=t[i]}s[r].hide();var m=a.getElementById("sidebar-"+e.rid);m.innerHTML="",m.appendChild(n),s[r].show()})},m=function(e,o){this.element=e,this.defaults={rid:"0",sid:"0",bnd1:[53.540307,-11.030273],bnd2:[39.095963,17.094727],maps:["OSM"],width:"100%",height:"500px",padding:3,deltazoom:0,scale:!0,fullscreen:!0,geocoder:!0,menu:!0,ameWeight:2,ameOpacity:.85,ameDash:"5,5",iak:"",ameColors:acyvar.ameColors},this.init(o)};m.prototype={init:function(o){for(var t={},p="OpenStreetMap",c=0,m=(o=e.extend(this.defaults,o)).maps.length;c<m;c++)switch(o.maps[c]){case"GMRMP":new L.gridLayer.googleMutant({type:"roadmap"});t["Google Roadmap"]=new L.gridLayer.googleMutant({type:"roadmap",minZoom:5,maxZoom:18}),0==c&&(p="Google Roadmap");break;case"GMSAT":t["Google Satellite"]=new L.gridLayer.googleMutant({type:"satellite",minZoom:5,maxZoom:18}),0==c&&(p="Google Satellite");break;case"GMTER":t["Google Terrain"]=new L.gridLayer.googleMutant({type:"terrain",minZoom:5,maxZoom:18}),0==c&&(p="Google Terrain");break;case"ETOPO":var l="https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",d='&copy; <a href="https://esriurl.com/WorldTopographicMapContributors">Esri World Topographic Map</a> contributors';t["ESRI Topo Map"]=new L.tileLayer(l,{minZoom:5,maxZoom:18,attribution:d}),0==c&&(p="ESRI Topo Map");break;case"EIMAG":l="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",d='&copy; <a href="https://esriurl.com/WorldImageryContributors">Esri World Imagery</a> contributors';t["ESRI Imagery"]=new L.TileLayer(l,{minZoom:5,maxZoom:18,attribution:d}),0==c&&(p="ESRI Imagery");break;case"MAPS":t["IGN Cartes"]=new L.tileLayer(r,{ignApiKey:o.iak,ignLayer:"GEOGRAPHICALGRIDSYSTEMS.MAPS",format:"image/jpeg",opacity:1,minZoom:3,maxZoom:20,attribution:n}),0==c&&(p="IGN Cartes");break;case"SCAN25":t["IGN Topo"]=new L.tileLayer(r,{ignApiKey:o.iak,ignLayer:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN25TOUR",format:"image/jpeg",opacity:1,minZoom:5,maxZoom:18,attribution:n}),0==c&&(p="IGN Topo");break;case"PLANS":t["IGN Plans"]=new L.tileLayer(r,{ignApiKey:"essentiels",ignLayer:"GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2",format:"image/png",opacity:1,minZoom:5,maxZoom:18,attribution:n}),0==c&&(p="IGN Plans");break;case"ORTHO":t["IGN Orthophotos"]=new L.tileLayer(r,{ignApiKey:"essentiels",ignLayer:"ORTHOIMAGERY.ORTHOPHOTOS",format:"image/jpeg",opacity:1,minZoom:5,maxZoom:18,attribution:n}),0==c&&(p="IGN Orthophotos");break;case"OCM":var y="https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey="+o.oak;t.OpenCycleMap=L.tileLayer(y,{minZoom:5,maxZoom:18,attribution:'&copy; <a href="https://www.thunderforest.com/maps/opencyclemap/">OpenCycleMap</a>'}),0==c&&(p="OpenCycleMap");break;case"OTM":t.OpenTopoMap=new L.TileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{minZoom:5,maxZoom:18,attribution:'&copy; <a href="https://www.opentopomap.org/">OpenTopoMap</a> contributors'}),0==c&&(p="OpenTopoMap");break;case"OSM":t.OpenStreetMap=new L.TileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:5,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),0==c&&(p="OpenStreetMap");break;case"COSM":default:t.CyclOSM=L.tileLayer("https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm//{z}/{x}/{y}.png",{minZoom:5,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),0==c&&(p="CyclOSM")}var g="map-"+o.rid;a.getElementById(g).style.width=o.width,a.getElementById(g).style.height=o.height;var h,u=L.map(g,{layers:[t[p]]});h=isNaN(o.padding)?3:Math.abs(o.padding),h=Math.abs(o.padding),u.fitBounds([o.bnd1,o.bnd2],{padding:[-h,-h]});var f=u.getZoom(),M=f+parseInt(o.deltazoom);if(M!==f&&u.setZoom(M),i[o.rid]=u,o.scale&&L.control.scale({imperial:!1}).addTo(u),o.maps.length>1){var S=L.control.layers(t,{},{collapsed:!1});S.addTo(u);var T=S.getContainer();e("#select-maps-"+o.rid).html(T)}if(o.fullscreen&&L.control.fullscreen({title:{false:"Affichage plein écran",true:"Sortir de l'affichage plein écran"},ctrl:"menu"}).addTo(u),o.geocoder){var b=new L.Control.OSMGeocoder({collapsed:!0,position:"topleft",text:"Rechercher"});u.addControl(b)}var w=L.control.sidebar1("sidebar-"+o.rid).addTo(u);if(s[o.rid]=w,o.menu)L.control.sidebar({container:"menu-"+o.rid,position:"right"}).addTo(u);void 0!==o.click&&"function"==typeof o.click&&u.on("click",o.click),void 0!==o.zoomend&&"function"==typeof o.zoomend&&u.on("zoomend",o.zoomend),void 0!==o.moveend&&"function"==typeof o.moveend&&u.on("moveend",o.moveend)},addAmes:function(o){!function(o){e.ajax({type:"post",url:acyvar.url+"wp-admin/admin-ajax.php",data:{action:"get-ames",rid:o.rid,sid:o.sid},dataType:"json",success:function(a){a&&function(o,a){if(a.length)for(var t=[],r=0,n=a.length;r<n;r++){for(var s=[],m=JSON.parse(a[r]),l=0,d=m.features.length;l<d;l++)m.features[l].rid=o.rid,s[l]=L.geoJson(m.features[l],{style:function(e){return p(o,e)},onEachFeature:function(e,a){return c(o,e,a)}});t[m.name]=L.layerGroup(s),i[o.rid].addLayer(t[m.name])}e("#select-ames-"+o.rid+" > ul :checkbox").on("change",function(e){var o=this.id,a=o.substr(o.lastIndexOf("-")+1);this.checked?i[a].addLayer(t[this.name]):i[a].removeLayer(t[this.name])}),e("#select-ames-"+o.rid+" > ul :checkbox").prop("checked",!0)}(o,a)}})}(o=e.extend(this.defaults,o))},onZoomend:function(e){return this.each(function(){void 0!==e&&"function"==typeof e&&map.on("zoomend",e)})},onMoveend:function(e){return this.each(function(){void 0!==e&&"function"==typeof e&&map.on("moveend",e)})},onClick:function(e){return this.each(function(){void 0!==e&&"function"==typeof e&&map.on("click",e)})}},e.fn.acyLeaflet=function(e){var o=this.data("plugin_acyLeaflet");return o instanceof m?void 0!==e&&o.init(e):(o=new m(this,e),this.data("plugin_acyLeaflet",o)),o}}(jQuery,window,document);